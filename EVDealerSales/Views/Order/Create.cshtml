@using EVDealerSales.BO.DTOs.OrderDTOs
@using EVDealerSales.BO.DTOs.OrderItemDTOs
@using EVDealerSales.BO.Enums
@model OrderDto

@{
    ViewData["Title"] = "Create Order";
}

<style>
    .form-container {
        max-width: 800px;
        margin: 2rem auto;
        padding: 0 1rem;
    }

    .form-card {
        background: #1a1a1a;
        border: 1px solid #2a2a2a;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
    }

    .form-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #2a2a2a;
    }

    .form-icon {
        width: 64px;
        height: 64px;
        border-radius: 16px;
        background: linear-gradient(135deg, #0070f3 0%, #00d4ff 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        font-size: 1.75rem;
        color: #fff;
    }

    .form-header h2 {
        color: #fff;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }

    .form-header p {
        color: #999;
        font-size: 0.9375rem;
        margin: 0;
    }

    .form-section {
        margin-bottom: 2rem;
    }

    .section-title {
        color: #fff;
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #2a2a2a;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .section-icon {
        width: 24px;
        height: 24px;
        border-radius: 6px;
        background: rgba(0, 112, 243, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        color: #0070f3;
    }

    .form-label {
        color: #ccc;
        font-size: 0.875rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
        display: block;
    }

    .form-control-modern {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        padding: 0.75rem;
        color: #fff;
        font-size: 0.9375rem;
        width: 100%;
        transition: all 0.2s ease;
    }

        .form-control-modern:focus {
            outline: none;
            border-color: #0070f3;
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 0 3px rgba(0, 112, 243, 0.1);
        }

        .form-control-modern::placeholder {
            color: #666;
        }

    textarea.form-control-modern {
        min-height: 100px;
        resize: vertical;
    }

    .text-danger {
        color: #e00;
        font-size: 0.8125rem;
        margin-top: 0.25rem;
        display: block;
    }

    .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        padding-top: 1.5rem;
        border-top: 1px solid #2a2a2a;
    }

    .btn-primary-modern {
        background: linear-gradient(135deg, #0070f3 0%, #00d4ff 100%);
        color: #fff;
        padding: 0.75rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

        .btn-primary-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 112, 243, 0.3);
        }

    .btn-secondary-modern {
        background: rgba(255, 255, 255, 0.03);
        color: #ccc;
        padding: 0.75rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        border: 1px solid rgba(255, 255, 255, 0.08);
        cursor: pointer;
        transition: all 0.2s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

        .btn-secondary-modern:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
            color: #fff;
        }
</style>

<div class="form-container">
    <div class="form-card">
        <div class="form-header">
            <div class="form-icon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <h2>Create New Order</h2>
            <p>Fill in the details to create a new order</p>
        </div>

        <form asp-action="Create" method="post">
            @Html.AntiForgeryToken()

            <div asp-validation-summary="All" class="text-danger mb-3"></div>
            <div class="form-section">
                <div class="section-title">
                    <span class="section-icon"><i class="fas fa-file-invoice"></i></span>
                    Order Information
                </div>

                <div class="mb-3">
                    <label class="form-label">Quote</label>
                    <select asp-for="QuoteId" class="form-control-modern" asp-items="@(ViewBag.Quotes as List<SelectListItem>)">
                    </select>
                    <span class="text-danger" asp-validation-for="QuoteId"></span>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label asp-for="OrderDate" class="form-label">Order Date</label>
                        <input asp-for="OrderDate" class="form-control-modern" type="date" />
                        <span class="text-danger" asp-validation-for="OrderDate"></span>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Status</label>
                        <select asp-for="Status" class="form-control-modern">
                            @foreach (OrderStatus st in Enum.GetValues(typeof(OrderStatus)))
                            {
                                <option value="@((int)st)" selected="@(st == Model.Status)">@st</option>
                            }
                        </select>
                        <span class="text-danger" asp-validation-for="Status"></span>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">
                    <span class="section-icon"><i class="fas fa-tag"></i></span>
                    Discount
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label asp-for="DiscountType" class="form-label">Discount Type</label>
                        <input asp-for="DiscountType" class="form-control-modern" placeholder="e.g., Seasonal, Loyalty" />
                        <span class="text-danger" asp-validation-for="DiscountType"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="DiscountValue" class="form-label">Discount Value</label>
                        <input asp-for="DiscountValue" class="form-control-modern" type="number" step="0.01" placeholder="0.00" />
                        <span class="text-danger" asp-validation-for="DiscountValue"></span>
                    </div>
                    <div class="col-12">
                        <label asp-for="DiscountNote" class="form-label">Discount Note</label>
                        <textarea asp-for="DiscountNote" class="form-control-modern" placeholder="Additional notes about the discount..."></textarea>
                        <span class="text-danger" asp-validation-for="DiscountNote"></span>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">
                    <span class="section-icon"><i class="fas fa-dollar-sign"></i></span>
                    Amounts
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label asp-for="SubtotalAmount" class="form-label">Subtotal Amount</label>
                        <input asp-for="SubtotalAmount" class="form-control-modern" type="number" step="0.01" placeholder="0.00" />
                        <span class="text-danger" asp-validation-for="SubtotalAmount"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="TotalAmount" class="form-label">Total Amount</label>
                        <input asp-for="TotalAmount" class="form-control-modern" type="number" step="0.01" placeholder="0.00" />
                        <span class="text-danger" asp-validation-for="TotalAmount"></span>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">
                    <span class="section-icon"><i class="fas fa-car"></i></span>
                    Item Details
                </div>

                <!-- Hidden fields to ensure binding -->
                <input type="hidden" asp-for="Items.VehicleId" />

                <div class="row g-3">
                    <div class="col-md-4">
                        <label asp-for="Items.Quantity" class="form-label">Quantity</label>
                        <input asp-for="Items.Quantity" class="form-control-modern" type="number" min="1" placeholder="1" />
                        <span class="text-danger" asp-validation-for="Items.Quantity"></span>
                    </div>
                    <div class="col-md-4">
                        <label asp-for="Items.UnitPrice" class="form-label">Unit Price</label>
                        <input asp-for="Items.UnitPrice" class="form-control-modern" type="number" step="0.01" placeholder="0.00" />
                        <span class="text-danger" asp-validation-for="Items.UnitPrice"></span>
                    </div>
                    <div class="col-md-4">
                        <label asp-for="Items.LineTotal" class="form-label">Line Total</label>
                        <input asp-for="Items.LineTotal" class="form-control-modern" type="number" step="0.01" placeholder="0.00" />
                        <span class="text-danger" asp-validation-for="Items.LineTotal"></span>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <a asp-action="Index" class="btn-secondary-modern">
                    <i class="fas fa-times"></i>
                    Cancel
                </a>
                <button type="submit" class="btn-primary-modern">
                    <i class="fas fa-check"></i>
                    Create Order
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
